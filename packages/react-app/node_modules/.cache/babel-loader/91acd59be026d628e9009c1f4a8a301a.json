{"ast":null,"code":"import { useState, useEffect } from \"react\";\nimport { getAddress } from \"@ethersproject/address\";\nimport { useLocalStorage } from \".\";\n\nconst lookupAddress = async (provider, address) => {\n  try {\n    // Accuracy of reverse resolution is not enforced.\n    // We then manually ensure that the reported ens name resolves to address\n    const reportedName = await provider.lookupAddress(address);\n    const resolvedAddress = await provider.resolveName(reportedName);\n\n    if (getAddress(address) === getAddress(resolvedAddress)) {\n      return reportedName;\n    }\n  } catch (e) {// Do nothing\n  }\n\n  return \"\";\n};\n\nconst useLookupAddress = (provider, address) => {\n  const [ensName, setEnsName] = useState(address);\n  const [ensCache, setEnsCache] = useLocalStorage(\"ensCache_\" + address);\n  useEffect(() => {\n    if (ensCache && ensCache.timestamp > Date.now()) {\n      setEnsName(ensCache.name);\n    } else if (provider) {\n      lookupAddress(provider, address).then(name => {\n        setEnsName(name);\n        setEnsCache({\n          timestamp: Date.now() + 360000,\n          name\n        });\n      });\n    }\n  }, [ensCache, provider, address, setEnsName, setEnsCache]);\n  return ensName;\n};\n\nexport default useLookupAddress;","map":{"version":3,"sources":["/Users/upalc/Documents/ethglobal/project/deapp/packages/react-app/src/hooks/LookupAddress.js"],"names":["useState","useEffect","getAddress","useLocalStorage","lookupAddress","provider","address","reportedName","resolvedAddress","resolveName","e","useLookupAddress","ensName","setEnsName","ensCache","setEnsCache","timestamp","Date","now","name","then"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,SAAnB,QAAoC,OAApC;AACA,SAASC,UAAT,QAA2B,wBAA3B;AACA,SAASC,eAAT,QAAgC,GAAhC;;AAEA,MAAMC,aAAa,GAAG,OAAOC,QAAP,EAAiBC,OAAjB,KAA6B;AACjD,MAAI;AACF;AACA;AACA,UAAMC,YAAY,GAAG,MAAMF,QAAQ,CAACD,aAAT,CAAuBE,OAAvB,CAA3B;AACA,UAAME,eAAe,GAAG,MAAMH,QAAQ,CAACI,WAAT,CAAqBF,YAArB,CAA9B;;AACA,QAAIL,UAAU,CAACI,OAAD,CAAV,KAAwBJ,UAAU,CAACM,eAAD,CAAtC,EAAyD;AACvD,aAAOD,YAAP;AACD;AACF,GARD,CAQE,OAAOG,CAAP,EAAU,CACV;AACD;;AACD,SAAO,EAAP;AACD,CAbD;;AAeA,MAAMC,gBAAgB,GAAG,CAACN,QAAD,EAAWC,OAAX,KAAuB;AAC9C,QAAM,CAACM,OAAD,EAAUC,UAAV,IAAwBb,QAAQ,CAACM,OAAD,CAAtC;AACA,QAAM,CAACQ,QAAD,EAAWC,WAAX,IAA0BZ,eAAe,CAAC,cAAcG,OAAf,CAA/C;AAEAL,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIa,QAAQ,IAAIA,QAAQ,CAACE,SAAT,GAAqBC,IAAI,CAACC,GAAL,EAArC,EAAiD;AAC/CL,MAAAA,UAAU,CAACC,QAAQ,CAACK,IAAV,CAAV;AACD,KAFD,MAEO,IAAId,QAAJ,EAAc;AACnBD,MAAAA,aAAa,CAACC,QAAD,EAAWC,OAAX,CAAb,CAAiCc,IAAjC,CAAsCD,IAAI,IAAI;AAC5CN,QAAAA,UAAU,CAACM,IAAD,CAAV;AACAJ,QAAAA,WAAW,CAAC;AACVC,UAAAA,SAAS,EAAEC,IAAI,CAACC,GAAL,KAAa,MADd;AAEVC,UAAAA;AAFU,SAAD,CAAX;AAID,OAND;AAOD;AACF,GAZQ,EAYN,CAACL,QAAD,EAAWT,QAAX,EAAqBC,OAArB,EAA8BO,UAA9B,EAA0CE,WAA1C,CAZM,CAAT;AAcA,SAAOH,OAAP;AACD,CAnBD;;AAqBA,eAAeD,gBAAf","sourcesContent":["import { useState, useEffect } from \"react\";\nimport { getAddress } from \"@ethersproject/address\";\nimport { useLocalStorage } from \".\";\n\nconst lookupAddress = async (provider, address) => {\n  try {\n    // Accuracy of reverse resolution is not enforced.\n    // We then manually ensure that the reported ens name resolves to address\n    const reportedName = await provider.lookupAddress(address);\n    const resolvedAddress = await provider.resolveName(reportedName);\n    if (getAddress(address) === getAddress(resolvedAddress)) {\n      return reportedName;\n    }\n  } catch (e) {\n    // Do nothing\n  }\n  return \"\";\n};\n\nconst useLookupAddress = (provider, address) => {\n  const [ensName, setEnsName] = useState(address);\n  const [ensCache, setEnsCache] = useLocalStorage(\"ensCache_\" + address);\n\n  useEffect(() => {\n    if (ensCache && ensCache.timestamp > Date.now()) {\n      setEnsName(ensCache.name);\n    } else if (provider) {\n      lookupAddress(provider, address).then(name => {\n        setEnsName(name);\n        setEnsCache({\n          timestamp: Date.now() + 360000,\n          name,\n        });\n      });\n    }\n  }, [ensCache, provider, address, setEnsName, setEnsCache]);\n\n  return ensName;\n};\n\nexport default useLookupAddress;\n"]},"metadata":{},"sourceType":"module"}